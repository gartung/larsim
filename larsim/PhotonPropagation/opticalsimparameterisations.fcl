# Contains information required for:
# Timing parameterisations for VUV and Visible photons
# Corrections for semi-analytic number of hits models for VUV and visible light

# *************************************************************************************************
#          PARAMETERS SETS FOR SEMI-ANALYTIC SIMULATION ARE DEFINED HERE FOR LATER USE                        
# *************************************************************************************************     
BEGIN_PROLOG

# VUV/DIRECT LIGHT: TIMING PARAMETERISATION
# Parameters of the Landau + Exponential (<= 300 cm) and Landau (> 300 cm) models
  # Landau parameters
  Distances_landau_all: [62.5, 87.5, 112.5, 137.5, 162.5, 187.5, 212.5, 237.5, 262.5, 287.5, 312.5, 337.5, 362.5, 387.5, 412.5, 437.5,
			 462.5, 487.5, 512.5, 537.5, 562.5, 587.5, 612.5, 637.5, 662.5, 687.5, 712.5, 737.5, 762.5, 787.5, 812.5, 837.5,
			 862.5, 887.5, 912.5, 937.5, 962.5, 987.5, 1012.5]
  Norm_over_entries_all: [1.46739, 0.880294, 0.571107, 0.344403, 0.261388, 0.20993, 0.170956, 0.152152, 0.136094, 0.120939, 0.109945, 0.10561,
			 0.0958589, 0.0904341, 0.0839861, 0.0803693, 0.0761224, 0.0716448, 0.0689223, 0.0668696, 0.0635322, 0.0616896, 0.0600554, 
			 0.0577425, 0.0561707, 0.0539962, 0.0517729, 0.050872, 0.0488119, 0.0469635, 0.0466058, 0.0453283, 0.04366, 0.0425648, 0.0411353, 
			 0.0396493, 0.0388351, 0.0383864, 0.0385728]
  Mpv_all: [6.05668, 9.05062, 12.3438, 17.1553, 21.9225, 26.9042, 33.1595, 37.1543, 43.6424, 49.9016, 55.7976, 59.7093, 66.7296, 72.5434, 78.6925, 84.1388, 
			 90.0175, 97.1053, 101.911, 107.799, 113.748, 119.527, 124.167, 130.438, 134.988, 141.886, 147.848, 153.056, 160.653, 168.234, 171.821,
			 178.68, 186.341, 193.222, 202.61, 212.357, 222.014, 232.012, 235.169]
  Width_all: [0.977654, 1.57296, 2.42236, 4.15371, 5.76189, 7.49866, 9.87714, 10.9349, 13.4434, 15.5028, 19.8005, 20.6927, 22.9557, 24.5475, 26.2879, 27.7879, 29.296,
			 31.1889, 32.5755, 33.5919, 35.4932, 36.7544, 37.8536, 39.5658, 40.8131, 42.6414, 44.6617, 45.9231, 48.2682, 50.799, 51.9537, 54.1583, 57.8934,
			 61.4115, 65.4056, 70.7218, 74.6922, 79.6439, 81.8717]
  # Exponential parameters
  Distances_exp_all: [55, 65, 75, 85, 95, 105, 115, 125, 135, 145, 155, 165, 175, 185, 195, 205, 215, 225, 235, 245, 255, 265, 275, 285, 295]
  Slope_all: [-0.0885849, -0.0688936, -0.0519349, -0.0481695, -0.0408145, -0.0359584, -0.0341716, -0.0302902, -0.0282722, -0.026348, -0.0240983, -0.023172, -0.0220861,
			 -0.0207058, -0.0197934, -0.0193794, -0.0182472, -0.0175204, -0.0173492, -0.0163832, -0.0164717, -0.0160823,-0.0153199, -0.0149124, -0.0142298]
  # Line fit to the profiles of the ratio between the normalization parameters of the exponential and the landau functions vs distance (<= 300 cm)
  # Fits made to profiles in three different offset angle bins [0, 30deg], [30deg, 60deg] and [60deg, 90 deg]
  Expo_over_Landau_norm_0_all:  [-4.44152e-02, 1.25321e-03]
  Expo_over_Landau_norm_30_all: [-2.74406e-02, 1.27240e-03]
  Expo_over_Landau_norm_60_all: [ 3.48944e-02, 1.27080e-03]

# VISIBLE/REFLECTED LIGHT: TIMING PARAMETERISATION
  # SBND
  Distances_refl_SBND: [25,40,60,80,100,120,140,160,180,200]
  Cut_off_SBND: [ [220.559,239.781,261.162,280.35,297.07,305.335,316.825,321.326,323.348,321.925],
		  [232.93,252.297,272.975,290.81,306.027,316.828,325.465,329.651,334.128,331.066],
		  [248.255,267.175,287.91,303.054,315.817,327.364,336.522,337.163,339.698,336.158],
		  [258.65,275.184,292.176,302.28,322.826,327.364,336.522,337.163,339.698,336.158] ]
  Tau_SBND: [ [9.65303,7.80435,4.45676,3.2075,2.40353,1.7977,1.337,0.799091,0.289916,0.00731707],
	      [11.7346,9.58924,5.45275,3.68209,2.69315,2.08817,1.48642,0.95226,0.411622,0.0406915],
	      [13.3461,11.8424,5.87778,4.09909,3.00104,2.22286,1.54286,1.05221,0.457658,0.0435644],
	      [14.2143,13.7812,6.58852,3.65,3.2,2.22286,1.54286,1.05221,0.457658,0.0435644] ]

 # DUNE-SP
  Distances_refl_SP: [38.3841,63.3841,88.3841,113.384,138.384,163.384,188.384,213.384,238.384,263.384,288.384,313.384,338.384]
  Cut_off_SP: [ [397.174,446.549,474.813,528.457,537.279,602.126,622.074,627.156,636.266,721.015,730.136,736.706,685.158],
		[435.09,483.062,515.06,559.063,591.479,593.486,617.949,681.81,730.478,702.538,686.021,664.066,654.974],
		[465.746,530.772,580.235,611.371,642.964,654.374,677.029,668.885,656.286,635.362,635.65,605.085,582.609],
		[519.167,569.909,578.288,596.77,610.101,624.591,601.545,591.347,605.464,578.32,551.695,549.043,514.396],		
		[480.531,503.503,541.092,551.809,542.019,531.692,549.968,564.952,517.862,432.633,523.463,511.93,511.93] ]
  Tau_SP: [ [5.62562,4.76375,3.33937,2.6725,2.16875,1.79792,1.5,1.28917,1.14875,1.015,0.789286,0.519643,0.553571],
	    [8.1424,4.63065,3.54856,2.77372,2.24805,1.95161,1.62822,1.38248,1.20475,1.07895,0.802715,0.653406,0.63129],
	    [7.27332,4.67257,3.54638,2.81115,2.36643,2.01963,1.7605,1.5292,1.38233,1.09352,0.852451,0.823318,0.771707],
	    [7.24211,4.46299,3.33076,2.65696,2.19649,1.83591,1.59777,1.43403,1.13786,1.15586,1.17439,1.39592,2.00126],
	    [7.00268,3.95271,2.88257,2.26547,1.83216,1.54479,1.38363,1.63333,1.57875,2.97708,2.52083,5.475,5.475] ]



# VUV/DIRECT LIGHT: NUMBER OF HITS CORRECTIONS
#  SBN Gaisser-Hillas                                                                  
 GH_RS60cm_SBN: [ [1.31326, 1.28293, 1.24304, 1.13739, 1.03286, 0.904908, 0.779762, 0.654461, 0.525548],
                  [87.5397, 95.0615, 89.6917, 94.9943, 93.9111, 111.708, 114.998, 132.535, 144.225],
		  [57.3686, 59.9412, 53.8011, 56.1887, 63.5782, 61.0104, 66.3173, 63.379, 64.4428],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
 GH_RS120cm_SBN: [ [1.16866, 1.13776, 1.08677, 0.993735, 0.885896, 0.760942, 0.628574, 0.498151, 0.37109],
                   [86.5078, 96.3383, 90.7074, 97.8305, 99.7487, 119.343, 129.554, 148.349, 174.775],
                   [88.0653, 89.4535, 82.9928, 84.9811, 93.5736, 89.2581, 93.4002, 91.709, 86.177],
                   [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
 GH_RS180cm_SBN: [ [1.11436, 1.08245, 1.02718, 0.939834, 0.83028, 0.704374, 0.566687, 0.430942, 0.299605],
                   [85.1942, 95.5351, 90.6834, 98.2426, 102.794, 123.284, 135.601, 153.886, 189.781],
                   [118.062, 119.348, 111.604, 112.464, 121.064, 114.846, 120.385, 119.249, 106.702],
                   [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
#  DUNE-SP Gaisser-Hillas                                        
 GH_RS60cm_SP: [ [1.37378, 1.3634, 1.31054, 1.23488, 1.14697, 1.01977, 0.886863, 0.751005, 0.592496],
                  [113.764, 128.753, 122.512, 141.309, 140.16, 153.797, 170.915, 184.999, 199.248],
                  [81.3747, 78.791, 87.2706, 81.9593, 92.3303, 102.592, 110.304, 112.577, 107.575],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
 GH_RS120cm_SP: [ [1.22881, 1.20776, 1.15355, 1.08087, 0.988751, 0.868487, 0.736578, 0.604445, 0.465248],
                  [120.126, 137.211, 129.695, 150.215, 151.926, 168.741, 199.556, 223.586, 260.437],
                  [120.445, 115.844, 127.995, 114.96, 130.093, 141.39, 147.55, 154.139, 136.948],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
 GH_RS180cm_SP: [ [1.16447, 1.14188, 1.08141, 1.00912, 0.911832, 0.793711, 0.656118, 0.517022, 0.38575],
                  [120.862, 138.321, 129.506, 152.468, 154.87, 171.04, 210.579, 240.266, 297.42],
                  [156.572, 146.229, 173.181, 147.513, 165.223, 175.133, 182.79, 211.805, 173.369],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
#  DUNE-DP Gaisser-Hillas                                                             
 GH_RS60cm_DP: [ [1.2378, 1.24291, 1.20084, 1.13647, 1.04805, 0.928209, 0.81468, 0.687154, 0.538787],
                  [95.9886, 105.046, 114.902, 121.08, 126.533, 142.666, 143.314, 156.796, 159.649],
                  [170.762, 161.485, 146.444, 136.313, 128.357, 112.543, 106.582, 88.2847, 81.1439],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
 GH_RS120cm_DP: [ [1.15393, 1.13664, 1.09137, 1.02059, 0.927886, 0.800404, 0.675405, 0.544569, 0.410451],
                  [120.77, 131.444, 136.192, 143.061, 153.195, 168.244, 176.448, 189.741, 209.645],
                  [250.962, 234.726, 217.918, 202.817, 185.121, 167.992, 156.201, 133.598, 111.581],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]
 GH_RS180cm_DP: [ [1.11356, 1.09376, 1.04515, 0.969378, 0.873762, 0.741592, 0.613477, 0.476078, 0.344799],
                  [129.151, 146.954, 147.726, 155.173, 166.108, 180.721, 193.948, 206.119, 240.13],
                  [321.246, 291.538, 278.321, 258.852, 234.141, 219.926, 197.511, 175.507, 139.981],
                  [-200, -200, -200, -200, -200, -200, -200, -200, -200] ]

# VIS/REFLECTED LIGHT: NUMBER OF HITS CORRECTIONS & PARAMETERS    
#  DUNE-SP Parameters
VIS_RS60cm_SP: [ [1.8492,1.77663,1.66362,1.48639,1.31516,1.29986,1.4445,1.4445,1.4445],
		 [-0.0218717,-0.0198687,-0.0183486,-0.0152432,-0.012402,-0.0114963,-0.0133689,-0.0133689,-0.0133689],
	 	 [0.000166354,0.000141254,0.000138214,0.000114116,9.25045e-05,8.60675e-05,0.000107824,0.000107824,0.000107824],
		 [-7.23103e-07,-5.65755e-07,-5.96314e-07,-4.9295e-07,-3.96589e-07,-3.69486e-07,-4.937e-07,-4.937e-07,-4.937e-07],
		 [1.66888e-09,1.21352e-09,1.37176e-09,1.14986e-09,9.26552e-10,8.85755e-10,1.22458e-09,1.22458e-09,1.22458e-09],
		 [-1.5687e-12,-1.08276e-12,-1.29085e-12,-1.1068e-12,-8.97237e-13,-8.89813e-13,-1.22944e-12,-1.22944e-12,-1.22944e-12] ]                                                                  
Plane_Depth_SP: 363.38405   		# foils/cathode x-coordinate
CATHODE_height_SP: 1209.466		# height of full cathode plane (in cm)
CATHODE_width_SP: 1394.34		# width of full cathode plane (in cm)
CATHODE_centre_SP: [363.38405, 0, 696.294]	# cathode centre coordinates

# SBND
Plane_Depth_SBND: 0			# foils/cathode x-coordinate; needed for SBND timings, SBND Nhits paramters not yet produced


# *************************************************************************************************
#  VUV semi-analytic model, generic for all exper
# *************************************************************************************************

common_vuv_timing_parameterization:
{
  # Timing parameterisaion:
  #
  # Parameters of the Landau + Exponential (<= 300 cm) and Landau (> 300 cm) models
  # Landau parameters
  Distances_landau: @local::Distances_landau_all
  Norm_over_entries: @local::Norm_over_entries_all
  Mpv: @local::Mpv_all
  Width: @local::Width_all
  
  # Exponential parameters
  Distances_exp: @local::Distances_exp_all
  Slope: @local::Slope_all
  
  # Normalisations
  Expo_over_Landau_norm_0:  @local::Expo_over_Landau_norm_0_all
  Expo_over_Landau_norm_30: @local::Expo_over_Landau_norm_30_all
  Expo_over_Landau_norm_60: @local::Expo_over_Landau_norm_60_all
   
  # Discretisation step size in cm
  step_size: 1. 
  # Maximum distance in cm parameterisations are generated for (only generated when required to prevent long initial loading time)
  max_d: 2500.
  # VUV group velocity in cm/ns
  vuv_vgroup_mean: 10.13
  vuv_vgroup_max: 15.
  # Distance in cm from "Landau + Expo" -> "Single Landau" model
  inflexion_point_distance: 300.
}




# *************************************************************************************************
#  VIS semi-analytic model, specific to DUNE
# *************************************************************************************************

dunesp_vis_timing_parameterization:
{
  Plane_Depth: @local::Plane_Depth_SP 

  # Timing parameterisation:
  #
  # Smearing parameters
  Distances_refl: @local::Distances_refl_SP
  Cut_off: @local::Cut_off_SP
  Tau: @local::Tau_SP

  # vis velocity in cm/ns
  vis_vmean: 23.99
  # LAr refractive indices
  n_LAr_VUV: 2.632 	# effective index due to group vel.
  n_LAr_vis: 1.23
}

dunesp_cathode_info_for_nhits_vis:
{
  # Cathode properties
  CATHODE_height: @local::CATHODE_height_SP
  CATHODE_width: @local::CATHODE_width_SP                    
  CATHODE_centre: @local::CATHODE_centre_SP
}

sbnd_vis_timing_parameterization:
{
  Plane_Depth: @local::Plane_Depth_SBND

  # Timing parameterisation:
  #
  # Smearing parameters
  Distances_refl: @local::Distances_refl_SBND
  Cut_off: @local::Cut_off_SBND
  Tau: @local::Tau_SBND

  # vis velocity in cm/ns
  vis_vmean: 23.99
  # LAr refractive indices
  n_LAr_VUV: 2.632      # effective index due to group vel.
  n_LAr_vis: 1.23
}


END_PROLOG









